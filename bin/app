#!/usr/bin/env ruby

$LOAD_PATH.unshift File.join(File.dirname(__FILE__), '..', 'lib')

require 'ui/console'
require 'ui/ui'

require 'db/reader'
require 'db/writer'
require 'db/db'

require 'screens/lister'
require 'screens/creator'
require 'screens/finder'
require 'screens/updater'

require 'menu'
require 'conman'

ui   = UI.new(Console.new($stdin, $stdout))

path = "./contacts"
db   = DB.new(Reader.new(path), Writer.new(path))

actions = [
  ["List contacts",   ListerScreen.new( ui, db)],
  ["Add contacts",    CreatorScreen.new(ui, db)],
  ["Search contacts", FinderScreen.new( ui, db)],
  ["Update contacts", UpdaterScreen.new( ui, db)],
  ["Exit",            nil]
]

menu   = Menu.new(ui, actions)
conman = Conman.new(menu)
conman.run